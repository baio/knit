// Generated by CoffeeScript 1.3.3
(function() {

  define(["ural/viewRender"], function(viewRender) {
    var applyData, render, _layoutModelsData;
    _layoutModelsData = [];
    render = function(path, done) {
      return viewRender.render(path, done);
    };
    applyData = function(bodyHtml, layoutModelsData, viewBag, isApply) {
      var layoutHtml, lmd, lt, _i, _j, _len, _len1;
      $.templates({
        pvt: bodyHtml
      });
      layoutHtml = $.render.pvt(viewBag);
      for (_i = 0, _len = _layoutModelsData.length; _i < _len; _i++) {
        lmd = _layoutModelsData[_i];
        lt = $("#" + lmd.layout)[0];
        ko.cleanNode(lt);
        $("[data-view-engine-clean]", lt).empty();
      }
      _layoutModelsData = [];
      $("#_layout").empty();
      $("#_layout").append(layoutHtml);
      if (isApply) {
        for (_j = 0, _len1 = layoutModelsData.length; _j < _len1; _j++) {
          lmd = layoutModelsData[_j];
          lt = $("#" + lmd.layout)[0];
          ko.applyBindings(lmd.data, lt);
        }
        return _layoutModelsData = layoutModelsData;
      }
    };
    return {
      render: render,
      applyData: applyData
    };
  });

}).call(this);
